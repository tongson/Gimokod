# Based upon the PKGBUILD from Arch Linux
pkgbase="libreoffice"
pkgname=('libreoffice-common'
         'libreoffice-base'
         'libreoffice-calc'
         'libreoffice-draw'
         'libreoffice-impress'
         'libreoffice-math'
         'libreoffice-writer'
         'libreoffice-en-US'
         'libreoffice-extension-diagram'
         'libreoffice-extension-ct2n'
         'libreoffice-extension-numbertext'
         'libreoffice-extension-oooblogger'
         'libreoffice-extension-pdfimport'
         'libreoffice-extension-presentation-minimizer'
         'libreoffice-extension-typo')
_LOver=3.4.3.2
pkgver=3.4.3
pkgrel=1
arch=('i686' 'x86_64')
_OFFICEUPD="340"
license=('LGPL3')
url="http://www.libreoffice.org/"
makedepends=('zip' 'unzip' 'gperf' 'poppler'
             'mythes' 'libxaw' 'hyphen' 'expat' 'perl-archive-zip'
             'mesa' 'curl' 'hunspell' 'pango' 'nspr' 'libjpeg' 'libxrandr' 'libgl' 'icu' 'libxslt'
             'redland' 'gcc-libs' 'libxrender' 'libxinerama' 'libcups'
             'hicolor-icon-theme' 'desktop-file-utils' 'shared-mime-info' 'gtk2'
             'ttf-dejavu')

_mirror="http://download.documentfoundation.org/libreoffice/src/${pkgver}"
#_additional_source_url="http://hg.services.openoffice.org/binaries"
_additional_source_url="http://dev-www.libreoffice.org/src/"
source=(${_mirror}/${pkgbase}-{artwork,base,bootstrap,calc,components,extensions,extras,filters,help,impress,libs-core,libs-extern,libs-extern-sys,libs-gui,postprocess,sdk,testing,ure,writer}-${_LOver}.tar.bz2 #,translations
  ${_additional_source_url}/1f24ab1d39f4a51faf22244c94a6203f-xmlsec1-1.2.14.tar.gz
  ${_additional_source_url}/35c94d2df8893241173de1d16b6034c0-swingExSrc.zip
  ${_additional_source_url}/798b2ffdc8bcfe7bca2cf92b62caf685-rhino1_5R5.zip
  ${_additional_source_url}/fdb27bfe2dbe2e7b57ae194d9bf36bab-SampleICC-1.3.2.tar.gz
  ${_additional_source_url}/ada24d37d8d638b3d8a9985e80bc2978-source-9.0.0.7-bj.zip
  ${_additional_source_url}/2a177023f9ea8ec8bd00837605c5df1b-jakarta-tomcat-5.0.30-src.tar.gz
  ${_additional_source_url}/a7983f859eafb2677d7ff386a023bc40-xsltml_2.1.2.zip
  ${_additional_source_url}/3c219630e4302863a9a83d0efde889db-commons-logging-1.1.1-src.tar.gz
  ${_additional_source_url}/2ae988b339daec234019a7066f96733e-commons-lang-2.3-src.tar.gz
  ${_additional_source_url}/2c9b0f83ed5890af02c0df1c1776f39b-commons-httpclient-3.1-src.tar.gz
  ${_additional_source_url}/af3c3acf618de6108d65fcdc92b492e1-commons-codec-1.3-src.tar.gz
  ${_additional_source_url}/eeb2c7ddf0d302fba4bfc6e97eac9624-libbase-1.1.6.zip
  ${_additional_source_url}/39bb3fcea1514f1369fcfc87542390fd-sacjava-1.3.zip
  ${_additional_source_url}/3404ab6b1792ae5f16bbd603bd1e1d03-libformula-1.1.7.zip
  ${_additional_source_url}/97b2d4dba862397f446b217e2b623e71-libloader-1.1.6.zip
  ${_additional_source_url}/f94d9870737518e3b597f9265f4e9803-libserializer-1.1.6.zip
  ${_additional_source_url}/8ce2fcd72becf06c41f7201d15373ed9-librepository-1.1.6.zip
  ${_additional_source_url}/d8bd5eed178db6e2b18eeed243f85aa8-flute-1.1.6.zip
  ${_additional_source_url}/3bdf40c0d199af31923e900d082ca2dd-libfonts-1.1.6.zip
  ${_additional_source_url}/ace6ab49184e329db254e454a010f56d-libxml-1.1.7.zip
  ${_additional_source_url}/db60e4fde8dd6d6807523deb71ee34dc-liblayout-0.2.10.zip
  ${_additional_source_url}/ba2930200c9f019c2d93a8c88c651a0f-flow-engine-0.9.4.zip
  ${_additional_source_url}/18f577b374d60b3c760a3a3350407632-STLport-4.5.tar.gz
  http://download.go-oo.org/src/0ff7d225d087793c8c2c680d77aac3e7-mdds_0.5.3.tar.bz2
  http://download.go-oo.org/extern/185d60944ea767075d27247c3162b3bc-unowinreg.dll
  http://download.go-oo.org/extern/b4cae0700aa1c2aef7eb7f345365e6f1-translate-toolkit-1.8.1.tar.bz2
  http://download.go-oo.org/src/90401bca927835b6fbae4a707ed187c8-nlpsolver-0.9.tar.bz2
  http://download.go-oo.org/src/f02578f5218f217a9f20e9c30e119c6a-boost_1_44_0.tar.bz2
  http://download.go-oo.org/src/0625a7d661f899a8ce263fc8a9879108-graphite2-0.9.2.tgz
  http://download.go-oo.org/src/451ccf439a36a568653b024534669971-ConvertTextToNumber-1.3.2.oxt
  http://ooo.itc.hu/oxygenoffice/download/libreoffice/7e7efc5d4a03126bb9ae3ae9aa2c4e87-Barcode_1.3.1.0.oxt
  http://ooo.itc.hu/oxygenoffice/download/libreoffice/41c9b65ad60af4b3255bbecdfef11736-Diagram_1.1.0.0.oxt
  http://ooo.itc.hu/oxygenoffice/download/libreoffice/bbdd5639ada63e3130761daaecae1a10-Validator_1.1.0.0.oxt
  http://ooo.itc.hu/oxygenoffice/download/libreoffice/23bd75552206dfcd8fd4e29137dcac84-WatchWindow_1.2.0.0.oxt
  http://ooo.itc.hu/oxygenoffice/download/libreoffice/b8cbca7b3363e6ca2d02bc0ba2b63904-numbertext_0.9.4.oxt
  http://ooo.itc.hu/oxygenoffice/download/libreoffice/b632bdd25649cc4067bcb410bae23d2b-hunart_0.3.oxt
  http://ooo.itc.hu/oxygenoffice/download/libreoffice/9d60b6cfa3ef1926848710bbcd11115b-typo_0.4.2.oxt
  http://ooo.itc.hu/oxygenoffice/download/libreoffice/dbaafd21de055e582d92d7d32fe9da13-gdocs_2.3.1.oxt
  http://ooo.itc.hu/oxygenoffice/download/libreoffice/b7b2d0e04e142f26dd96119c80757d1f-oooblogger_0.1.oxt
  buildfix_boost.diff
  buildfix_ct2n.diff
  vbahelper.visibility.patch
  scp2-more-reasonable-file-access-rights.diff
  java-detection.diff::http://cgit.freedesktop.org/libreoffice/libs-core/patch/?id=14bc9100d36eae3999f1623efce8ee84091da842
  oracle-recognition.diff::http://cgit.freedesktop.org/libreoffice/core/patch/?id=549e54fb2f8113502743c443d6deadfe648dede1
  poppler-check.diff::http://cgit.freedesktop.org/libreoffice/bootstrap/patch/?id=72a5f87cb3f0a367f1cd6a5cc15101acc83396fe
  pdfimport.diff::http://cgit.freedesktop.org/libreoffice/extensions/patch/?id=53e66aea4c1b3617363fd138a7903190d964da6b
  poppler-buildfix.diff::http://cgit.freedesktop.org/libreoffice/extensions/patch/?id=9540db43f3f1b11d3407a45aefda235d7e78f76b
  build-without-glib-poppler-bindings.diff::http://cgit.freedesktop.org/libreoffice/extensions/patch/?id=a9cc06fa45d4cd9547f40a9869c64c912b821b42
  ${_additional_source_url}/71474203939fafbe271e1263e61d083e-nss-3.12.8-with-nspr-4.8.6.tar.gz
  ${_additional_source_url}/bd30e9cf5523cdfc019b94f5e1d7fd19-cppunit-1.12.1.tar.gz)
noextract=(185d60944ea767075d27247c3162b3bc-unowinreg.dll
  b4cae0700aa1c2aef7eb7f345365e6f1-translate-toolkit-1.8.1.tar.bz2
  0ff7d225d087793c8c2c680d77aac3e7-mdds_0.5.3.tar.bz2
  ada24d37d8d638b3d8a9985e80bc2978-source-9.0.0.7-bj.zip
  798b2ffdc8bcfe7bca2cf92b62caf685-rhino1_5R5.zip
  1f24ab1d39f4a51faf22244c94a6203f-xmlsec1-1.2.14.tar.gz
  fdb27bfe2dbe2e7b57ae194d9bf36bab-SampleICC-1.3.2.tar.gz
  35c94d2df8893241173de1d16b6034c0-swingExSrc.zip
  2a177023f9ea8ec8bd00837605c5df1b-jakarta-tomcat-5.0.30-src.tar.gz
  a7983f859eafb2677d7ff386a023bc40-xsltml_2.1.2.zip
  3c219630e4302863a9a83d0efde889db-commons-logging-1.1.1-src.tar.gz
  2ae988b339daec234019a7066f96733e-commons-lang-2.3-src.tar.gz
  2c9b0f83ed5890af02c0df1c1776f39b-commons-httpclient-3.1-src.tar.gz
  af3c3acf618de6108d65fcdc92b492e1-commons-codec-1.3-src.tar.gz
  eeb2c7ddf0d302fba4bfc6e97eac9624-libbase-1.1.6.zip
  39bb3fcea1514f1369fcfc87542390fd-sacjava-1.3.zip
  3404ab6b1792ae5f16bbd603bd1e1d03-libformula-1.1.7.zip
  97b2d4dba862397f446b217e2b623e71-libloader-1.1.6.zip
  f94d9870737518e3b597f9265f4e9803-libserializer-1.1.6.zip
  8ce2fcd72becf06c41f7201d15373ed9-librepository-1.1.6.zip
  d8bd5eed178db6e2b18eeed243f85aa8-flute-1.1.6.zip
  3bdf40c0d199af31923e900d082ca2dd-libfonts-1.1.6.zip
  ace6ab49184e329db254e454a010f56d-libxml-1.1.7.zip
  db60e4fde8dd6d6807523deb71ee34dc-liblayout-0.2.10.zip
  ba2930200c9f019c2d93a8c88c651a0f-flow-engine-0.9.4.zip
  18f577b374d60b3c760a3a3350407632-STLport-4.5.tar.gz
  7e7efc5d4a03126bb9ae3ae9aa2c4e87-Barcode_1.3.1.0.oxt
  41c9b65ad60af4b3255bbecdfef11736-Diagram_1.1.0.0.oxt
  451ccf439a36a568653b024534669971-ConvertTextToNumber-1.3.2.oxt
  bbdd5639ada63e3130761daaecae1a10-Validator_1.1.0.0.oxt
  23bd75552206dfcd8fd4e29137dcac84-WatchWindow_1.2.0.0.oxt
  b8cbca7b3363e6ca2d02bc0ba2b63904-numbertext_0.9.4.oxt
  b632bdd25649cc4067bcb410bae23d2b-hunart_0.3.oxt
  9d60b6cfa3ef1926848710bbcd11115b-typo_0.4.2.oxt
  dbaafd21de055e582d92d7d32fe9da13-gdocs_2.3.1.oxt
  b7b2d0e04e142f26dd96119c80757d1f-oooblogger_0.1.oxt
  90401bca927835b6fbae4a707ed187c8-nlpsolver-0.9.tar.bz2
  f02578f5218f217a9f20e9c30e119c6a-boost_1_44_0.tar.bz2
  0625a7d661f899a8ce263fc8a9879108-graphite2-0.9.2.tgz
  71474203939fafbe271e1263e61d083e-nss-3.12.8-with-nspr-4.8.6.tar.gz
  bd30e9cf5523cdfc019b94f5e1d7fd19-cppunit-1.12.1.tar.gz)
md5sums=('7c2e73f1197d169519f86efe422e5df9'
         '823956297a7e0b7603c585c49bd9fd4e'
         '465b3be0e30f88e1139c45d2e2217927'
         'a1d5af5be5eb522c8a24feacbb0161fa'
         '8b972e130dfe62eb41d1d71d72de4b76'
         'a6b22494e3a65a3b242ecb896aa7ab48'
         'b7d86f8baee5b31af210cc81785e5676'
         'de6c062d334daab99cf0592aa3568215'
         'df46914d540ef0126cd746d09c68ca2a'
         '8f308250c397ddc6fdb1aae13e102927'
         '1fd00a0fcfd4a5d1956c3f6a0990d1ce'
         '86914ac8bc30ea721b708b2f2faa3111'
         '1452229e57ac3c4191e798eac4c0a7e0'
         'bb46bdb682689629d432cdbf5f3f42c2'
         'bec7f633562762debdf810690002e688'
         '87061613efece1c253906a90cd4dc01f'
         '308284d7d1d1bd6860d128b26e24390b'
         'fa8b36365a2b2fb110c44886d7069774'
         'da8a40cac4bd9d4f6f326e0e3b1b7e2a'
         '1f24ab1d39f4a51faf22244c94a6203f'
         '35c94d2df8893241173de1d16b6034c0'
         '798b2ffdc8bcfe7bca2cf92b62caf685'
         'fdb27bfe2dbe2e7b57ae194d9bf36bab'
         'ada24d37d8d638b3d8a9985e80bc2978'
         '2a177023f9ea8ec8bd00837605c5df1b'
         'a7983f859eafb2677d7ff386a023bc40'
         '3c219630e4302863a9a83d0efde889db'
         '2ae988b339daec234019a7066f96733e'
         '2c9b0f83ed5890af02c0df1c1776f39b'
         'af3c3acf618de6108d65fcdc92b492e1'
         'eeb2c7ddf0d302fba4bfc6e97eac9624'
         '39bb3fcea1514f1369fcfc87542390fd'
         '3404ab6b1792ae5f16bbd603bd1e1d03'
         '97b2d4dba862397f446b217e2b623e71'
         'f94d9870737518e3b597f9265f4e9803'
         '8ce2fcd72becf06c41f7201d15373ed9'
         'd8bd5eed178db6e2b18eeed243f85aa8'
         '3bdf40c0d199af31923e900d082ca2dd'
         'ace6ab49184e329db254e454a010f56d'
         'db60e4fde8dd6d6807523deb71ee34dc'
         'ba2930200c9f019c2d93a8c88c651a0f'
         '18f577b374d60b3c760a3a3350407632'
         '0ff7d225d087793c8c2c680d77aac3e7'
         '185d60944ea767075d27247c3162b3bc'
         'b4cae0700aa1c2aef7eb7f345365e6f1'
         '90401bca927835b6fbae4a707ed187c8'
         'f02578f5218f217a9f20e9c30e119c6a'
         '0625a7d661f899a8ce263fc8a9879108'
         '451ccf439a36a568653b024534669971'
         '7e7efc5d4a03126bb9ae3ae9aa2c4e87'
         '41c9b65ad60af4b3255bbecdfef11736'
         'bbdd5639ada63e3130761daaecae1a10'
         '23bd75552206dfcd8fd4e29137dcac84'
         'b8cbca7b3363e6ca2d02bc0ba2b63904'
         'b632bdd25649cc4067bcb410bae23d2b'
         '9d60b6cfa3ef1926848710bbcd11115b'
         'dbaafd21de055e582d92d7d32fe9da13'
         'b7b2d0e04e142f26dd96119c80757d1f'
         'bc228237108cab7745897a9f466b6d39'
         'eee273f501ff45dc5f1365e78c6d57c0'
         '43b145db28e6c0d73578ae6fd35e510d'
         '37638431e7e40baf2e47966ebb9bc0e9'
         'ca6032e86229ae798f3744ae244f5bfe'
         '3c6c62e77c30649a3dfe73512947cc9a'
         '64497be966802e62ffe3282d3facf7b7'
         '89ff871e77e10357a976fe9d1ab3a65a'
         'c4cb0d7f2602396a3f4cac55b8a4e308'
         'b8f1fb7f3902d22aeaa2575c6b08a62c'
         '71474203939fafbe271e1263e61d083e'
         'bd30e9cf5523cdfc019b94f5e1d7fd19')

build() {

  # move all LibO sources into one build directory
  mkdir "${srcdir}"/build && cd "${srcdir}"/build
  for i in libreoffice-{artwork,base,bootstrap,calc,components,extensions,extras,filters,help,impress,libs-core,libs-extern,libs-extern-sys,libs-gui,postprocess,sdk,testing,ure,writer}-${_LOver}; do
    mv "${srcdir}"/$i/* .
  done

  # move external sources into place
  mkdir "${srcdir}"/ext_sources &&  cd "${srcdir}"/ext_sources
  for source in "${noextract[@]}"; do
    ln -s "${srcdir}"/$source .
  done

  cd "${srcdir}"/build

  # buildfixes & bugfixes
  Patch buildfix_boost.diff
  Patch buildfix_ct2n.diff
  Patch scp2-more-reasonable-file-access-rights.diff
  Patch poppler-check.diff
  Patch pdfimport.diff
  Patch poppler-buildfix.diff
  Patch build-without-glib-poppler-bindings.diff

  # Gentoo
  Patch libreoffice-libdb5-fix-check.diff
  Patch libreoffice-3.4.1-salfix.diff
  Patch sdext-presenter.diff
  Patch libreoffice-svx.patch
  Patch libreoffice-as-needed-gtk.patch
  Patch libreoffice-translate-toolkit-parallel-solenv.patch
  Patch libreoffice-gbuild-use-cxxflags.patch
  Patch libreoffice-check-for-avx.patch
  Patch libreoffice-append-no-avx.patch
  Patch libreoffice-binfilter-as-needed.patch
  Patch libreoffice-kill-cppunit.patch
  Patch libreoffice-honor-strip.patch

  # unset C(XX)FLAGS
  # http://www.openoffice.org/issues/show_bug.cgi?id=103205

  #use the CFLAGS but remove the LibO overridden ones
  for i in $CFLAGS; do
    case "$i" in
      -O?|-pipe|-Wall|-g|-fexceptions) continue;;
    esac
        ARCH_FLAGS="$ARCH_FLAGS $i"
  done

  # http://wiki.documentfoundation.org/Development/How_to_build/Configure_options

  # needed for 0003-distro-install-fix-en-US-only-installation.patch
  autoconf -f

  # non-SMP test build
  ./configure --without-system-hsqldb \
              --without-system-sane-header \
              --without-junit \
              --without-java \
              --without-system-vigra \
              --enable-cups \
              --disable-broffice \
              --enable-unix-qstart-libpng \
              --disable-epm \
              --disable-fetch-external \
              --disable-kdeab \
              --disable-dbus \
              --disable-pch \
              --disable-rpath \
              --disable-online-update \
              --disable-static-gtk \
              --disable-gconf \
              --disable-gstreamer \
              --disable-vba \
              --disable-activex-component \
              --without-openldap \
              --without-stlport \
              --enable-largefile \
              --enable-Xaw \
              --enable-xrender-link \
              --enable-randr \
              --enable-randr-link \
              --disable-neon \
              --with-build-version="${_LOver} Gimokod build-${pkgrel}" \
              --with-vendor="Gimokod" \
              --with-unix-wrapper="libreoffice" \
              --enable-split-app-modules \
              --with-max-jobs=${MAKEFLAGS/-j/} \
              --with-num-cpus=1 \
              --with-x \
              --with-external-tar="${srcdir}/ext_sources" \
              --prefix=/usr \
              --build=${CBUILD} \
              --host=${CHOST} \
              --exec-prefix=/usr \
              --sysconfdir=/etc \
              --with-install-dirname="${pkgbase}" \
              --libdir=/usr/lib \
              --mandir=/usr/share/man \
              --without-system-zlib \
              --disable-verbose \
              --with-lang="" \
              --enable-cairo \
              --disable-crashdump \
              --disable-dependency-tracking \
              --enable-dbus \
              --disable-evolution2 \
              --disable-graphite \
              --without-system-graphite \
              --disable-gio \
              --disable-gnome-vfs \
              --disable-kde \
              --disable-kde4 \
              --disable-ldap \
              --disable-lockdown \
              --disable-static-gtk \
              --disable-systray \
              --disable-zenity \
              --without-helppack-integration \
              --with-extension-integration \
              --enable-opengl \
              --enable-odk\
              --enable-opengl \
              --enable-ext-barcode \
              --enable-ext-diagram \
              --disable-ext-google-docs \
              --disable-ext-hunart \
              --disable-ext-lightproof \
              --disable-ext-mysql-connector \
              --without-system-lpsolve \
              --enable-ext-ct2n \
              --enable-ext-numbertext \
              --enable-ext-oooblogger \
              --enable-ext-pdfimport \
              --disable-ext-presenter-console \
              --enable-ext-presenter-minimizer \
              --disable-ext-scripting-beanshell \
              --disable-ext-scripting-javascript \
              --disable-ext-scripting-python \
              --disable-ext-nlpsolver \
              --enable-ext-typo \
              --disable-ext-validator \
              --disable-ext-watch-window \
              --disable-ext-wiki-publisher \
              --without-fonts \
              --without-afms \
              --without-ppds \
              --without-system-libwps \
              --without-system-mdds \
              --without-system-lucene \
              --without-myspell-dicts \
              --with-system-dicts \
              --with-external-dict-dir=/usr/share/hunspell \
              --with-external-hyph-dir=/usr/share/hyphen \
              --with-external-thes-dir=/usr/share/mythes \
              --without-system-cppunit \
              --without-system-libwpd \
              --without-system-libwpg \
              --without-system-libwps \
              --with-system-redland \
              --without-system-saxon \
              --without-openldap \
              --without-system-boost \
              --with-system-cairo \
              --with-system-libs \
              --disable-mozilla \
              --without-system-mozilla \
              --without-sun-templates \
              --with-system-mythes \
              --with-system-xrender-headers \
              --with-system-headers \
              --without-system-beanshell \
              --without-system-odbc \
              --with-alloc=system

  touch src.downloaded
  #./download
  unset MAKEFLAGS
  ./bootstrap
  make
  # fake installation to create split file lists
  mkdir "${srcdir}"/fakeinstall
  make DESTDIR=${srcdir}/fakeinstall distro-pack-install
}


package_libreoffice-common() {
 pkgdesc="common files for LibreOffice - a productivity suite that is compatible with other major office suites"
 install=${pkgbase}.install
 depends=('libreoffice-langpack' 'curl' 'hunspell'  'libxaw'
          'pango' 'nspr' 'libjpeg' 'libxrandr' 'libgl' 'libxslt' 'icu'
          'redland' 'hyphen' 'gcc-libs' 'libcups'
          'hicolor-icon-theme' 'desktop-file-utils' 'shared-mime-info' 'gtk2')
 backup=(etc/libreoffice/sofficerc
         etc/libreoffice/bootstraprc
         etc/libreoffice/psprint.conf)
 groups=('libreoffice')

 # create directories from *list.txt file
 for directory in `grep ^%dir "${srcdir}"/build/file-lists/common_list.txt`; do
   install -dm755 "${pkgdir}"/${directory/\%dir/}
 done
 # install files into the pkg from fakeinstall dir
 for file in `grep -v ^%dir "${srcdir}"/build/file-lists/common_list.txt`; do
   dirname=`dirname $file`
   # check if directory has been already been created - some are missing like manpages
   [ -d "${pkgdir}"/$dirname ] || install -dm755 "${pkgdir}"/$dirname
   # mv file from fakeinstall to pkgdir
   mv "${srcdir}"/fakeinstall${file} ${pkgdir}$file
 done

 #  # remove version in menu entry and make it visible

 # put configuration files into place
 install -dm755 "${pkgdir}"/etc/libreoffice
 install -m644 "${pkgdir}"/usr/lib/libreoffice/program/{bootstraprc,sofficerc} "${pkgdir}"/etc/libreoffice/
 install -m644 "${pkgdir}"/usr/lib/libreoffice/basis3.4/share/psprint/psprint.conf "${pkgdir}"/etc/libreoffice/
 # install dummy links to make them found by LibO
 cd "${pkgdir}"/usr/lib/libreoffice/program/
 ln -vsf /etc/libreoffice/{bootstraprc,sofficerc} .
 cd "${pkgdir}"/usr/lib/libreoffice/basis3.4/share/psprint/
 ln -vsf /etc/libreoffice/psprint.conf .
}

package_libreoffice-base() {
 pkgdesc="GUI Spreadsheet Applicationdatabase front-end for LibreOffice. Allows creation and management of databases through a GUI."
 depends=('libreoffice-common')
 groups=('libreoffice')

 # create directories from *list.txt file
 for directory in `grep ^%dir "${srcdir}"/build/file-lists/base_list.txt`; do
   install -dm755 "${pkgdir}"/${directory/\%dir/}
 done
 # install files into the pkg from fakeinstall dir
 for file in `grep -v ^%dir "${srcdir}"/build/file-lists/base_list.txt`; do
   dirname=`dirname $file`
   # check if directory has been already been created - some are missing like manpages
   [ -d "${pkgdir}"/$dirname ] || install -dm755 "${pkgdir}"/$dirname
   # mv file from fakeinstall to pkgdir
   mv "${srcdir}"/fakeinstall${file} ${pkgdir}$file
 done
}

package_libreoffice-calc() {
 pkgdesc="Spreadsheet application for LibreOffice."
 depends=('libreoffice-common')
 groups=('libreoffice')

 # create directories from *list.txt file
 for directory in `grep ^%dir "${srcdir}"/build/file-lists/calc_list.txt`; do
   install -dm755 "${pkgdir}"/${directory/\%dir/}
 done
 # install files into the pkg from fakeinstall dir
 for file in `grep -v ^%dir "${srcdir}"/build/file-lists/calc_list.txt`; do
   dirname=`dirname $file`
   # check if directory has been already been created - some are missing like manpages
   [ -d "${pkgdir}"/$dirname ] || install -dm755 "${pkgdir}"/$dirname
   # mv file from fakeinstall to pkgdir
   mv "${srcdir}"/fakeinstall${file} ${pkgdir}$file
 done
}

package_libreoffice-draw() {
 pkgdesc="Drawing Application for LibreOffice."
 depends=('libreoffice-common')
 groups=('libreoffice')

 # create directories from *list.txt file
 for directory in `grep ^%dir "${srcdir}"/build/file-lists/draw_list.txt`; do
   install -dm755 "${pkgdir}"/${directory/\%dir/}
 done
 # install files into the pkg from fakeinstall dir
 for file in `grep -v ^%dir "${srcdir}"/build/file-lists/draw_list.txt`; do
   dirname=`dirname $file`
   # check if directory has been already been created - some are missing like manpages
   [ -d "${pkgdir}"/$dirname ] || install -dm755 "${pkgdir}"/$dirname
   # mv file from fakeinstall to pkgdir
   mv "${srcdir}"/fakeinstall${file} ${pkgdir}$file
 done
}


package_libreoffice-impress() {
 pkgdesc="Presentation Application for LibreOffice."
 depends=('libreoffice-common' 'mesa')
 groups=('libreoffice')

 # create directories from *list.txt file
 for directory in `grep ^%dir "${srcdir}"/build/file-lists/impress_list.txt`; do
   install -dm755 "${pkgdir}"/${directory/\%dir/}
 done
 # install files into the pkg from fakeinstall dir
 for file in `grep -v ^%dir "${srcdir}"/build/file-lists/impress_list.txt`; do
   dirname=`dirname $file`
   # check if directory has been already been created - some are missing like manpages
   [ -d "${pkgdir}"/$dirname ] || install -dm755 "${pkgdir}"/$dirname
   # mv file from fakeinstall to pkgdir
   mv "${srcdir}"/fakeinstall${file} ${pkgdir}$file
 done
}


package_libreoffice-math() {
 pkgdesc="Equation Editor Applicationfor LibreOffice."
 depends=('libreoffice-common')
 groups=('libreoffice')

 # create directories from *list.txt file
 for directory in `grep ^%dir "${srcdir}"/build/file-lists/math_list.txt`; do
   install -dm755 "${pkgdir}"/${directory/\%dir/}
 done
 # install files into the pkg from fakeinstall dir
 for file in `grep -v ^%dir "${srcdir}"/build/file-lists/math_list.txt`; do
   dirname=`dirname $file`
   # check if directory has been already been created - some are missing like manpages
   [ -d "${pkgdir}"/$dirname ] || install -dm755 "${pkgdir}"/$dirname
   # mv file from fakeinstall to pkgdir
   mv "${srcdir}"/fakeinstall${file} ${pkgdir}$file
 done
}



package_libreoffice-writer() {
 pkgdesc="Word Processor Applicationfor LibreOffice."
 depends=('libreoffice-common' 'libxml2')
 groups=('libreoffice')

 # create directories from *list.txt file
 for directory in `grep ^%dir "${srcdir}"/build/file-lists/writer_list.txt`; do
   install -dm755 "${pkgdir}"/${directory/\%dir/}
 done
 # install files into the pkg from fakeinstall dir
 for file in `grep -v ^%dir "${srcdir}"/build/file-lists/writer_list.txt`; do
   dirname=`dirname $file`
   # check if directory has been already been created - some are missing like manpages
   [ -d "${pkgdir}"/$dirname ] || install -dm755 "${pkgdir}"/$dirname
   # mv file from fakeinstall to pkgdir
   mv "${srcdir}"/fakeinstall${file} ${pkgdir}$file
 done
}

package_libreoffice-en-US() {
  pkgdesc="English (US) language pack for LibreOffice"
  provides=('libreoffice-langpack')

 # create directories from *list.txt file
 for directory in `grep ^%dir "${srcdir}"/build/file-lists/lang_en_US_list.txt`; do
   install -dm755 "${pkgdir}"/${directory/\%dir/}
 done
 # install files into the pkg from fakeinstall dir
 for file in `grep -v ^%dir "${srcdir}"/build/file-lists/lang_en_US_list.txt`; do
   dirname=`dirname $file`
   # check if directory has been already been created - some are missing like manpages
   [ -d "${pkgdir}"/$dirname ] || install -dm755 "${pkgdir}"/$dirname
   # mv file from fakeinstall to pkgdir
   mv "${srcdir}"/fakeinstall${file} ${pkgdir}$file
 done
}

package_libreoffice-extension-barcode() {
 pkgdesc="This extension generates UPC-A, EAN-13, ISBN and JAN barcodes in Draw "
 depends=('libreoffice-common')
 groups=('libreoffice-extensions')

  install -dm755 "${pkgdir}"/usr/lib/libreoffice/share/extensions
  unzip -q "${srcdir}"/7e7efc5d4a03126bb9ae3ae9aa2c4e87-Barcode_1.3.1.0.oxt -d "${pkgdir}"/usr/lib/libreoffice/share/extensions/Barcode
  chmod o-w -R "${pkgdir}"/usr/lib/libreoffice/share/extensions/Barcode
}

package_libreoffice-extension-diagram() {
 pkgdesc="An OOo Draw and Impress extension that creates your favorite diagrams with a few clicks"
 depends=('libreoffice-common' 'java-environment')
 groups=('libreoffice-extensions')

  install -dm755 "${pkgdir}"/usr/lib/libreoffice/share/extensions
  unzip -q "${srcdir}"/41c9b65ad60af4b3255bbecdfef11736-Diagram_1.1.0.0.oxt -d "${pkgdir}"/usr/lib/libreoffice/share/extensions/diagram
}

package_libreoffice-extension-ct2n() {
 pkgdesc="This extension enables you to convert text-cells in Calc with numbers and dates, to real numbers and dates."
 depends=('libreoffice-common')
 groups=('libreoffice-extensions')

  install -dm755 "${pkgdir}"/usr/lib/libreoffice/share/extensions
  unzip -q "${srcdir}"/build/solver/${_OFFICEUPD}/unxlng*/bin/ConvertTextToNumber.oxt -d "${pkgdir}"/usr/lib/libreoffice/share/extensions/ct2n
}

package_libreoffice-extension-numbertext() {
 pkgdesc="NUMBERTEXT/MONEYTEXT extensions"
 depends=('libreoffice-common')
 groups=('libreoffice-extensions')

  install -dm755 "${pkgdir}"/usr/lib/libreoffice/share/extensions
  unzip -q "${srcdir}"/b8cbca7b3363e6ca2d02bc0ba2b63904-numbertext_0.9.4.oxt -d "${pkgdir}"/usr/lib/libreoffice/share/extensions/numbertext
}

package_libreoffice-extension-oooblogger() {
 pkgdesc="An extensions for blogging"
 depends=('libreoffice-common')
 groups=('libreoffice-extensions')

  install -dm755 "${pkgdir}"/usr/lib/libreoffice/share/extensions
  unzip -q "${srcdir}"/b7b2d0e04e142f26dd96119c80757d1f-oooblogger_0.1.oxt -d "${pkgdir}"/usr/lib/libreoffice/share/extensions/oooblogger
}

package_libreoffice-extension-pdfimport() {
 pkgdesc="This extension allows you to import and modify PDF documents"
 depends=('libreoffice-common' 'poppler')
 groups=('libreoffice-extensions')

  install -dm755 "${pkgdir}"/usr/lib/libreoffice/share/extensions
  unzip -q "${srcdir}"/build/solver/${_OFFICEUPD}/unxlng*/bin/pdfimport/pdfimport.oxt -d "${pkgdir}"/usr/lib/libreoffice/share/extensions/pdfimport
}

package_libreoffice-extension-presentation-minimizer() {
 pkgdesc="This extension reduce the file size of the current presentation"
 depends=('libreoffice-common' 'gcc-libs')
 groups=('libreoffice-extensions')

  install -dm755 "${pkgdir}"/usr/lib/libreoffice/share/extensions
  unzip -q "${srcdir}"/build/solver/${_OFFICEUPD}/unxlng*/bin/presentation-minimizer.oxt -d "${pkgdir}"/usr/lib/libreoffice/share/extensions/presentation-minimizer
}

package_libreoffice-extension-typo() {
 pkgdesc="Typography toolbar extension"
 depends=('libreoffice-common')
 groups=('libreoffice-extensions')

 install -dm755 "${pkgdir}"/usr/lib/libreoffice/share/extensions
 unzip -q "${srcdir}"/9d60b6cfa3ef1926848710bbcd11115b-typo_0.4.2.oxt -d "${pkgdir}"/usr/lib/libreoffice/share/extensions/typo
  find ${pkgdir} -type d -exec chmod 755 {} \;
}

source=(${source[@]-}
        libreoffice-3.4.1-salfix.diff
        libreoffice-append-no-avx.patch
        libreoffice-as-needed-gtk.patch
        libreoffice-binfilter-as-needed.patch
        libreoffice-check-for-avx.patch
        libreoffice-gbuild-use-cxxflags.patch
        libreoffice-honor-strip.patch
        libreoffice-kill-cppunit.patch
        libreoffice-libdb5-fix-check.diff
        libreoffice-poppler-0.18.0-2.patch
        libreoffice-poppler-0.18.0.patch
        libreoffice-solenv-build-crash.patch
        libreoffice-svx.patch
        libreoffice-translate-toolkit-parallel-solenv.patch
        sdext-presenter.diff)

md5sums=(${md5sums[@]-}
            'c85f718e91afd85bde6d350dfe018a9f'
            'a81ba299a5c14ee79134f74f15a33dff'
            '930fc77683b8223bfe12eea69401711e'
            '2905a9920b06072afb85ff882f9b07c6'
            '856c06e3666673199deda221e76de00e'
            'bed1f64484a1b027d8a335bd1d00b75b'
            'c2e561b5258da01236790b71ec1d9cbf'
            '731d314f77dd76243d2e243387e7773f'
            '661394b4e40bb273e87508a581968138'
            'c4cb0d7f2602396a3f4cac55b8a4e308'
            '89ff871e77e10357a976fe9d1ab3a65a'
            'eee273f501ff45dc5f1365e78c6d57c0'
            '004e4f85891631d5d01d615cd25f2e39'
            'a78ea519d4876eadf8da5ffa0b180c55'
            'db736d3d3e6be31edf7853ab3e7c0c70')
