# Based upon the PKGBUILD from Arch Linux
pkgname=kmod
pkgver=6
pkgrel=1
pkgdesc="Linux kernel module handling"
arch=('i686' 'x86_64')
url='http://git.kernel.org/?p=utils/kernel/kmod/kmod.git;a=summary'
license=('GPL2')
depends=('zlib')
groups=('base')
options=('!libtool')
source=("ftp://ftp.kernel.org/pub/linux/utils/kernel/$pkgname/$pkgname-$pkgver.tar.xz")
md5sums=('bad08102fad212cd34405136d9a7eb94')

build() {
  cd "${pkgname}-${pkgver}"
  touch libkmod/docs/gtk-doc.make
  ./configure \
    --sysconfdir=/etc \
    --disable-debug \
    --disable-gtk-doc \
    --without-xz \
    --enable-tools \
    --with-rootprefix=/usr \
    --with-zlib
  make
}

package() {
  make -C "${pkgname}-${pkgver}" DESTDIR="${pkgdir}" install
  for tool in {ls,ins,rm,dep}mod mod{info,probe}; do
    ln -s kmod "$pkgdir/usr/bin/$tool"
  done
}

