# Based upon the PKGBUILD from Arch Linux
pkgname=iproute2
pkgver=3.3.0
pkgrel=2
pkgdesc="IP Routing Utilities"
arch=('x86_64')
license=('GPL2')
url="http://www.linux-foundation.org/en/Net:Iproute2"
groups=('base')
options=('!makeflags')
makedepends=('bison' 'flex' 'libnl')
install=iproute2.install
source=(http://www.kernel.org/pub/linux/utils/net/$pkgname/$pkgname-$pkgver.tar.xz
       iproute2-fhs.patch)
sha1sums=('25307c2418b9d4c6433d61a296f50b886da84b8c'
          '78d6d2cb17b33ac89094aa3ed4810d81bb43c3d9')

build() {
  cd "${srcdir}/${pkgname}-${pkgver}"
  sed -i '/^TARGETS=/s: arpd : :' misc/Makefile
  patch -Np1 -i "${srcdir}"/iproute2-fhs.patch
  ./configure --build=${CBUILD} --host=${CHOST}
  make
}

package() {
  cd "${srcdir}/${pkgname}-${pkgver}"
  make DESTDIR="${pkgdir}" install
  install -D -m0644 include/libnetlink.h "${pkgdir}"/usr/include/libnetlink.h
  install -D -m0644 lib/libnetlink.a "${pkgdir}"/usr/lib/libnetlink.a
}
