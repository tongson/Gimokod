pkgname=alternatives
_pkgname=chkconfig
pkgver=1.3.56
pkgrel=2
pkgdesc="reimplementation of the Debian alternatives system by Red Hat"
arch=('x86_64')
url="https://fedorahosted.org/releases/c/h/chkconfig/"
license=('GPL2')
groups=('base')
options=('emptydirs')
makedepends=('musl')
source=(http://fedorahosted.org/releases/c/h/chkconfig/${_pkgname}-${pkgver}.tar.bz2
        alternatives-nogettext.diff)
sha256sums=('cffab1de494120bf92ed27c9e6ccbd22c78a710231a618966b1f6238044aa964'
            '5c56f3df8673878ef05a5b74cc91ccae7fd6ed213061f93f61512291b4ebe726')

build() {
  cd "${srcdir}/${_pkgname}-${pkgver}"
  Patch alternatives-nogettext.diff
  make alternatives CFLAGS="${CFLAGS}" LDFLAGS="${LDFLAGS} -Wl,-z,noexecstack" CC="/usr/lib/musl/bin/musl-gcc -nostdinc -static"
}

package() {
  cd "${srcdir}/${_pkgname}-${pkgver}"
  install -D -m0700 alternatives "${pkgdir}/usr/bin/alternatives"
  install -d -m0755 "${pkgdir}/etc/alternatives"
  install -d -m0755 "${pkgdir}/var/lib/alternatives"
  install -D -m0644 alternatives.8 "${pkgdir}/usr/share/man/man8/alternatives.8"
}

