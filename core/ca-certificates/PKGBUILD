pkgname=ca-certificates
pkgver=20120212
pkgrel=2
pkgdesc='Common CA certificates'
arch=('any')
url='http://packages.qa.debian.org/c/ca-certificates.html'
license=('MPL' 'GPL')
groups=('base')
depends=('openssl')
install=ca-certificates.install

build() {
  cd ${srcdir}
  mkdir ${pkgname}-${pkgver}
  cd ${pkgname}-${pkgver}
  tar -xzf ../data.tar.gz
  cd ..
  rm control.tar.gz  data.tar.gz  debian-binary
}

package() {
  cd "${srcdir}/${pkgname}-${pkgver}"
  cp -pPR * "${pkgdir}"/
  (
  echo "# Automatically generated by ${pkgname}-${pkgver}-${pkgrel}"
  echo "# $(date -u)"
  cd "${pkgdir}"/usr/share/ca-certificates
  find . -name '*.crt' | LC_ALL=C sort | cut -b3-
  ) > "${pkgdir}"/etc/ca-certificates.conf
  install -d -m755 "${pkgdir}/usr/bin"
  mv "${pkgdir}"/usr/sbin/* "${pkgdir}/usr/bin"
  rmdir "${pkgdir}/usr/sbin"
  pushd "${pkgdir}"
    Patch ca-certificates-20110502-root.patch
  popd
}
source=("http://ftp.debian.org/debian/pool/main/c/${pkgname}/${pkgname}_${pkgver}_all.deb")
sha256sums=('7e4277a0a5a0ac42c370a93f986839b4e3ff82646581caa8c5135ad0a41d01d7')

source=(${source[@]-}
        ca-certificates-20110502-root.patch)

sha256sums=(${sha256sums[@]-}
            'ca13364ad47efd748da856b8863129f188379721106295ef4c349d2075cea8bd')
